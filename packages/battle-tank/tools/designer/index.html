<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Battle Tank Map Designer</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Monaco', 'Courier New', monospace;
      background: #0a0a0a;
      color: #ddd;
      overflow: hidden;
    }

    #app {
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    /* Toolbar */
    #toolbar {
      background: #1a1a1a;
      border-bottom: 1px solid #333;
      padding: 8px 12px;
      display: flex;
      gap: 8px;
      align-items: center;
    }

    button {
      background: #2a2a2a;
      border: 1px solid #444;
      color: #ddd;
      padding: 6px 12px;
      cursor: pointer;
      font-family: inherit;
      font-size: 12px;
      border-radius: 3px;
    }

    button:hover {
      background: #333;
      border-color: #555;
    }

    button.active {
      background: #00ff88;
      color: #000;
      border-color: #00ff88;
    }

    .divider {
      width: 1px;
      height: 20px;
      background: #333;
      margin: 0 4px;
    }

    /* Main layout */
    #main {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    /* Left panel */
    #left-panel {
      width: 20%;
      background: #1a1a1a;
      border-right: 1px solid #333;
      padding: 12px;
      overflow-y: auto;
    }

    .panel-section {
      margin-bottom: 20px;
    }

    .panel-section h3 {
      font-size: 11px;
      text-transform: uppercase;
      color: #888;
      margin-bottom: 8px;
      letter-spacing: 0.5px;
    }

    .tool-group {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .tool-btn {
      padding: 8px;
      text-align: left;
      font-size: 11px;
    }

    /* Viewport */
    #viewport {
      flex: 1;
      position: relative;
      overflow: hidden;
    }

    #designer-canvas {
      display: block;
      width: 100%;
      height: 100%;
      cursor: crosshair;
    }

    /* Right panel (inspector) */
    #right-panel {
      width: 20%;
      background: #1a1a1a;
      border-left: 1px solid #333;
      padding: 12px;
      overflow-y: auto;
    }

    .inspector-row {
      margin-bottom: 12px;
    }

    .inspector-row label {
      display: block;
      font-size: 10px;
      color: #888;
      margin-bottom: 4px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .inspector-row select,
    .inspector-row input {
      width: 100%;
      background: #2a2a2a;
      border: 1px solid #444;
      color: #ddd;
      padding: 6px;
      font-family: inherit;
      font-size: 11px;
      border-radius: 3px;
    }

    .inspector-row select:focus,
    .inspector-row input:focus {
      outline: none;
      border-color: #00ff88;
    }

    #validation-panel {
      margin-top: 16px;
      padding: 8px;
      background: #0a0a0a;
      border-radius: 3px;
      font-size: 10px;
    }

    .validation-ok {
      color: #00ff88;
    }

    .validation-error {
      color: #ff3333;
    }

    .validation-warning {
      color: #ffaa00;
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- Toolbar -->
    <div id="toolbar">
      <button id="btn-load">Load</button>
      <button id="btn-save">Save</button>
      <button id="btn-export">Export .ts</button>
      <div class="divider"></div>
      <button id="btn-undo">Undo</button>
      <button id="btn-redo">Redo</button>
      <div class="divider"></div>
      <button id="btn-toggle-symbols">Show Symbols</button>
      <div class="divider"></div>
      <span style="font-size: 11px; color: #666; flex: 1; text-align: right;">
        Battle Tank Map Designer
      </span>
    </div>

    <!-- Main layout -->
    <div id="main">
      <!-- Left panel: Tools -->
      <div id="left-panel">
        <div class="panel-section">
          <h3>Tools</h3>
          <div class="tool-group">
            <button id="tool-select" class="tool-btn active">‚óâ Select</button>
            <button id="tool-paint" class="tool-btn">üñå Paint</button>
            <button id="tool-erase" class="tool-btn">‚å´ Erase</button>
            <button id="tool-fill" class="tool-btn" disabled style="opacity: 0.4; cursor: not-allowed;">‚¨ö Fill</button>
            <button id="tool-rect" class="tool-btn" disabled style="opacity: 0.4; cursor: not-allowed;">‚ñ≠ Rect</button>
          </div>
        </div>

        <div class="panel-section">
          <h3>Palette</h3>
          <div style="font-size: 9px; color: #666; margin-bottom: 12px; line-height: 1.4;">
            1. Select Paint tool<br>
            2. Pick terrain & object<br>
            3. Click canvas to paint
          </div>
          <div class="inspector-row">
            <label>Ground</label>
            <select id="palette-ground">
              <!-- Populated dynamically from TerrainData.json -->
            </select>
          </div>

          <div class="inspector-row">
            <label>Object</label>
            <select id="palette-object">
              <option value="none">None</option>
              <!-- Populated dynamically from ObjectData.json -->
            </select>
          </div>

          <div class="inspector-row">
            <label>Rotation</label>
            <select id="palette-rotation">
              <option value="0">0¬∞</option>
              <option value="90">90¬∞</option>
              <option value="180">180¬∞</option>
              <option value="270">270¬∞</option>
            </select>
          </div>
        </div>

        <div class="panel-section">
          <h3>Shortcuts</h3>
          <div style="font-size: 9px; color: #666; line-height: 1.6;">
            <div><kbd>Ctrl+Z</kbd> Undo</div>
            <div><kbd>Ctrl+Y</kbd> Redo</div>
            <div><kbd>Ctrl+S</kbd> Save</div>
            <div><kbd>G</kbd> Toggle Grid</div>
            <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #333;">
              <div><kbd>Space+Drag</kbd> Pan</div>
              <div><kbd>Mid-Drag</kbd> Pan (mouse)</div>
              <div><kbd>Wheel</kbd> Zoom (mouse)</div>
              <div><kbd>Ctrl+Wheel</kbd> Zoom (trackpad)</div>
              <div><kbd>‚Üë‚Üì‚Üê‚Üí</kbd> Pan (arrows)</div>
              <div><kbd>Shift+Arrow</kbd> Fast pan</div>
              <div><kbd>Ctrl+0</kbd> Reset zoom</div>
              <div><kbd>Ctrl+1/2/3</kbd> 50%/100%/200%</div>
              <div><kbd>E</kbd> Rotate CW</div>
              <div><kbd>Q</kbd> Rotate CCW</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Viewport -->
      <div id="viewport">
        <canvas id="designer-canvas"></canvas>
      </div>

      <!-- Right panel: Inspector -->
      <div id="right-panel">
        <div class="panel-section">
          <h3>Map Info</h3>
          <div class="inspector-row" style="font-size: 10px; color: #888;">
            <div id="map-status">No map loaded</div>
          </div>
          <div class="inspector-row">
            <label>Background Dim</label>
            <div style="display: flex; gap: 6px; align-items: center;">
              <input
                type="range"
                id="bg-opacity-slider"
                min="0"
                max="100"
                value="100"
                style="flex: 1; cursor: pointer;"
              >
              <span id="bg-opacity-value" style="font-size: 10px; color: #888; min-width: 30px;">100%</span>
            </div>
          </div>
          <div class="inspector-row">
            <button id="btn-toggle-zones" style="width: 100%; margin-top: 8px;">Show Zones</button>
          </div>
        </div>

        <div class="panel-section">
          <h3>Map Details</h3>
          <div id="map-details" style="font-size: 9px; color: #aaa; line-height: 1.5;">
            <div style="color: #888;">‚Ä¢ Load a map to see details</div>
          </div>
        </div>

        <div class="panel-section">
          <h3>Inspector</h3>
          <div class="inspector-row">
            <label>Position</label>
            <div id="inspector-position" style="color: #00ff88; font-size: 12px;">-</div>
          </div>

          <div class="inspector-row">
            <label>Ground</label>
            <select id="inspector-ground">
              <!-- Populated dynamically from TerrainData.json -->
            </select>
          </div>

          <div id="terrain-archetype-profile" style="margin-top: 6px;"></div>

          <div class="inspector-row">
            <label>Object</label>
            <select id="inspector-object">
              <option value="none">None</option>
              <!-- Populated dynamically from ObjectData.json -->
            </select>
          </div>

          <div class="inspector-row">
            <label>Rotation</label>
            <select id="inspector-rotation">
              <option value="0">0¬∞</option>
              <option value="90">90¬∞</option>
              <option value="180">180¬∞</option>
              <option value="270">270¬∞</option>
            </select>
          </div>
        </div>

        <div id="object-transform-panel" class="panel-section" style="display: none;">
          <h3>Object Transform</h3>

          <div class="inspector-row">
            <label>Scale <span id="transform-scale-value" style="color: #00ff88;">1.00</span></label>
            <input type="range" id="transform-scale" min="25" max="200" value="100" step="5" style="cursor: pointer;">
          </div>

          <div class="inspector-row">
            <label>Offset X <span id="transform-offsetX-value" style="color: #00ff88;">0.00</span></label>
            <input type="range" id="transform-offsetX" min="-50" max="50" value="0" step="5" style="cursor: pointer;">
          </div>

          <div class="inspector-row">
            <label>Offset Y <span id="transform-offsetY-value" style="color: #00ff88;">0.00</span></label>
            <input type="range" id="transform-offsetY" min="-50" max="50" value="0" step="5" style="cursor: pointer;">
          </div>

          <button id="btn-reset-transform" style="width: 100%; margin-top: 4px;">Reset Transform</button>
        </div>

        <div id="object-properties-panel" class="panel-section" style="display: none;">
          <h3>Object Properties</h3>

          <div class="inspector-row" style="font-size: 10px;">
            <label>Category</label>
            <div id="prop-category" style="color: #888;">-</div>
          </div>

          <div class="inspector-row" style="font-size: 10px;">
            <label>Strategic Role</label>
            <div id="prop-role" style="color: #888;">-</div>
          </div>

          <div id="archetype-profile-object" style="margin-top: 6px;"></div>

          <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #333;">
            <div class="inspector-row">
              <label style="display: flex; align-items: center; gap: 6px;">
                <input type="checkbox" id="prop-isImpassable" style="width: auto;">
                <span>Impassable</span>
              </label>
            </div>
            <div class="inspector-row">
              <label style="display: flex; align-items: center; gap: 6px;">
                <input type="checkbox" id="prop-isDestructible" style="width: auto;">
                <span>Destructible</span>
              </label>
            </div>
            <div class="inspector-row">
              <label style="display: flex; align-items: center; gap: 6px;">
                <input type="checkbox" id="prop-isVisualOverlay" style="width: auto;">
                <span>Visual Overlay</span>
              </label>
            </div>
          </div>

          <div class="inspector-row">
            <label>Clear Speed</label>
            <input type="number" id="prop-clearSpeed" step="0.1" min="0">
          </div>

          <div class="inspector-row">
            <label>Strategic Role (Override)</label>
            <input type="text" id="prop-strategicRole" placeholder="e.g., Map dividers">
          </div>
        </div>

        <div id="particle-effect-panel" class="panel-section" style="display: none;">
          <h3>Particle Effect</h3>

          <div class="inspector-row">
            <label>Effect Type</label>
            <select id="particle-effect-type">
              <option value="">None</option>
              <option value="smoke">Smoke</option>
              <option value="fire">Fire</option>
              <option value="dust">Dust</option>
              <option value="sparks">Sparks</option>
              <option value="steam">Steam</option>
            </select>
          </div>

          <div class="inspector-row">
            <label>Size <span id="particle-size-value" style="color: #00ff88;">1.00</span></label>
            <input type="range" id="particle-size" min="25" max="300" value="100" step="10" style="cursor: pointer;">
          </div>

          <div class="inspector-row">
            <label>Offset X <span id="particle-offsetX-value" style="color: #00ff88;">0.00</span></label>
            <input type="range" id="particle-offsetX" min="-50" max="50" value="0" step="5" style="cursor: pointer;">
          </div>

          <div class="inspector-row">
            <label>Offset Y <span id="particle-offsetY-value" style="color: #00ff88;">0.00</span></label>
            <input type="range" id="particle-offsetY" min="-50" max="50" value="0" step="5" style="cursor: pointer;">
          </div>

          <button id="btn-clear-particle" style="width: 100%; margin-top: 4px;">Clear Effect</button>
        </div>

        <div id="validation-panel">
          <h3 style="font-size: 10px; margin-bottom: 6px;">Validation</h3>
          <div id="validation-status" class="validation-ok">
            ‚Ä¢ Load a map to begin
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="./main.ts"></script>
</body>
</html>
